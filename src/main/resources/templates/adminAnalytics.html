<!DOCTYPE html>
<html lang="en">

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ASHRC</title>
    <link rel = "icon" href ="/img/RcLogo.png"
          type = "image/x-icon">
    <style>
        @import url(https://unpkg.com/@webpixels/css@1.1.5/dist/index.css);
        @import url("https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.4.0/font/bootstrap-icons.min.css");

        .topnav {
            overflow: hidden;
            background-color: #923D41;
        }

        .topnav a {
            float: left;
            color: #f2f2f2;
            text-align: center;
            padding: 25px 30px;
            text-decoration: none;
            font-size: 17px;
        }

        .topnav a:hover {
            background-color: #ddd;
            color: black;
        }
        body{background: whitesmoke}

        .Linecontainer {
            width: 60%;
            margin: 15px 20px;
            margin-left: 17%;
        }


    </style>

</head>
<body>
<!-- Banner -->
<div class="topnav"><p style="color: #923D41">m</p></div>
<div class="d-flex flex-column flex-lg-row h-lg-full bg-surface-secondary">
    <!-- Vertical Navbar -->
    <nav class="navbar show navbar-vertical h-lg-screen navbar-expand-lg px-0 py-3 navbar-light bg-white border-bottom border-bottom-lg-0 border-end-lg" id="navbarVertical">
        <div class="container-fluid">
            <!-- Toggler --> <button class="navbar-toggler ms-n2" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarCollapse" aria-controls="sidebarCollapse" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <!-- Brand -->

            <h3 style="font-family: Serif; color: #923D41; margin-left: 5%"><i class="bi bi-cone-striped"></i>  Safe Haven<a href="javascript:void(0)" class="closebtn" onclick="closeNav()"><i style="color: #923D41;padding-left: 70px" class="bi bi-arrow-left"></i></a>
            </h3>
            </br>
            <div class="navbar-user d-lg-none">
                <!-- Dropdown -->
                <div class="dropdown">
                    <!-- Toggle --> <a href="#" id="sidebarAvatar" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <div class="avatar-parent-child"> <img alt="Image Placeholder" src="https://images.unsplash.com/photo-1548142813-c348350df52b?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=3&w=256&h=256&q=80" class="avatar avatar- rounded-circle"> <span class="avatar-child avatar-badge bg-success"></span> </div>
                </a> <!-- Menu -->
                    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="sidebarAvatar"> <a href="#" class="dropdown-item">Profile</a> <a href="#" class="dropdown-item">Settings</a>
                        <hr class="dropdown-divider"> <a href="/admin/logout" class="dropdown-item">Logout</a> </div>
                </div>
            </div> <!-- Collapse -->
            <div class="collapse navbar-collapse" id="sidebarCollapse">
                <!-- Navigation -->
                <ul class="navbar-nav">
                    <li class="nav-item"> <a class="nav-link" href="/admin/dashboard"> <i style="color: #923D41" class="bi bi-house"></i> Dashboard </a> </li>
                    <li class="nav-item"> <a class="nav-link" href="/admin/analytics"> <i style="color: #923D41" class="bi bi-bar-chart"></i> Analytics </a> </li>
                    <li class="nav-item"> <a class="nav-link" href="/admin/reportProcessing"> <i style="color: #923D41" class="bi bi-flag"></i> Report Processing <span class="badge bg-soft-primary text-primary rounded-pill d-inline-flex align-items-center ms-auto" th:text="${newlyReceived}">6</span> </a> </li>
                    <li class="nav-item"> <a class="nav-link" href="/admin/incidentAnalysis"> <i style="color: #923D41" class="bi bi-bookmarks"></i> Incident Analysis </a> </li>
                    <li class="nav-item"> <a class="nav-link" href="/admin/respondents"> <i style="color: #923D41" class="bi bi-people"></i> Respondents </a> </li>
                </ul> <!-- Divider -->
                <hr class="navbar-divider my-5 opacity-20"> <!-- Navigation -->
                <ul class="navbar-nav mb-md-4">
                    <li>
                        <div class="nav-link text-xs font-semibold text-uppercase text-muted ls-wide" href="#"> Contacts <span class="badge bg-soft-primary text-primary rounded-pill d-inline-flex align-items-center ms-4">13</span> </div>
                    </li>
                    <li> <a href="#" class="nav-link d-flex align-items-center">
                        <div class="me-4">
                            <div class="position-relative d-inline-block text-white"> <img alt="Image Placeholder" src="https://images.unsplash.com/photo-1548142813-c348350df52b?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=3&w=256&h=256&q=80" class="avatar rounded-circle"> <span class="position-absolute bottom-2 end-2 transform translate-x-1/2 translate-y-1/2 border-2 border-solid border-current w-3 h-3 bg-success rounded-circle"></span> </div>
                        </div>
                        <div> <span class="d-block text-sm font-semibold"> Diana Davis </span> <span class="d-block text-xs text-muted font-regular"> Counsellor </span> </div>
                        <div class="ms-auto"> <i class="bi bi-chat"></i> </div>
                    </a> </li>
                    <li> <a href="#" class="nav-link d-flex align-items-center">
                        <div class="me-4">
                            <div class="position-relative d-inline-block text-white"> <span class="avatar bg-soft-warning text-warning rounded-circle">MD</span> <span class="position-absolute bottom-2 end-2 transform translate-x-1/2 translate-y-1/2 border-2 border-solid border-current w-3 h-3 bg-success rounded-circle"></span> </div>
                        </div>
                        <div> <span class="d-block text-sm font-semibold"> Miriam Duke </span> <span class="d-block text-xs text-muted font-regular"> Peer Coach </span> </div>
                        <div class="ms-auto"> <i class="bi bi-chat"></i> </div>
                    </a> </li>
                    <li> <a href="#" class="nav-link d-flex align-items-center">
                        <div class="me-4">
                            <div class="position-relative d-inline-block text-white"> <img alt="..." src="https://images.unsplash.com/photo-1610899922902-c471ae684eff?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=3&w=256&h=256&q=80" class="avatar rounded-circle"> <span class="position-absolute bottom-2 end-2 transform translate-x-1/2 translate-y-1/2 border-2 border-solid border-current w-3 h-3 bg-danger rounded-circle"></span> </div>
                        </div>
                        <div> <span class="d-block text-sm font-semibold"> Deborah Kontoh </span> <span class="d-block text-xs text-muted font-regular"> Peer Coach </span> </div>
                        <div class="ms-auto"> <i class="bi bi-chat"></i> </div>
                    </a> </li>
                </ul>

                <ul class="navbar-nav">
                    <li class="nav-item"> <a class="nav-link" href="#"> <i class="bi bi-person-square"></i> My Account </a> </li>
                    <li class="nav-item"> <a class="nav-link" href="#"> <i class="bi bi-box-arrow-left"></i> Logout </a> </li>
                </ul>
            </div>
        </div>
    </nav> <!-- Main content -->
    <div class="h-screen flex-grow-1 overflow-y-lg-auto">
        <!-- Header -->
        <header class="bg-surface-primary border-bottom pt-6">
            <div class="container-fluid">
                <div class="mb-npx">
                    <div class="row align-items-center">
                        <div class="col-sm-6 col-12 mb-4 mb-sm-0">
                            <!-- Title -->
                            <h1 style="font-family: Serif"><button style="background-color: white" class="openbtn" onclick="openNav()"><i class="bi bi-bar-chart-steps"></i></button>   Analytics</h1>
                        </div> <!-- Actions -->
                        <div class="col-sm-6 col-12 text-sm-end">
                            <div class="mx-n1"> <a href="#" class="btn d-inline-flex btn-sm btn-neutral border-base mx-1"> <span class=" pe-2"> <i style="color: #923D41" class="bi bi-printer" onclick="window.print()"></i> </span> <span onclick="window.print()">Print</span> </a> <a href="/admin/settings" style="color: #923D41"> <i class="bi bi-gear"></i></span> </a> </div>
                        </div>
                    </div> <!-- Nav -->
                    <ul class="nav nav-tabs mt-4 overflow-x border-0">

                    </ul>
                </div>
            </div>
        </header>
        <div class="card-body">
            <div class="row">
                <div class="card shadow border-0 mb-7">
                    <br/>
                    <div class="Linecontainer">
                        <div>
                            <canvas id="myLineChart"></canvas>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="row py-2">
            <div class="col-md-4 py-1">
                <div class="card">
                    <div class="card-body">
                        <canvas id="myUserChart" ></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-4 py-1">
                <div class="card">
                    <div class="card-body">
                        <canvas id="myVicChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-4 py-1">
                <div class="card">
                    <div class="card-body">
                        <canvas id="myOffChart"></canvas>
                    </div>
                </div>
            </div></div>



    </div>
</div>


<input id = "jan" type="hidden"  th:value="${DashStats.getJanCases()}">
<input id = "feb" type="hidden"  th:value="${DashStats.getFebCases()}">
<input id = "mar" type="hidden"  th:value="${DashStats.getMarCases()}">
<input id = "apr" type="hidden"  th:value="${DashStats.getAprCases()}">
<input id = "may" type="hidden"  th:value="${DashStats.getMayCases()}">
<input id = "jun" type="hidden"  th:value="${DashStats.getJunCases()}">
<input id = "jul" type="hidden"  th:value="${DashStats.getJulCases()}">
<input id = "aug" type="hidden"  th:value="${DashStats.getAugCases()}">
<input id = "sep" type="hidden"  th:value="${DashStats.getSepCases()}">
<input id = "oct" type="hidden"  th:value="${DashStats.getOctCases()}">
<input id = "nov" type="hidden"  th:value="${DashStats.getNovCases()}">
<input id = "dec" type="hidden"  th:value="${DashStats.getDecCases()}">
<script>
    var ctx = document.getElementById("myLineChart").getContext("2d");
    var a = Number(document.getElementById("jan").value);
    var b = Number(document.getElementById("feb").value);
    var c = Number(document.getElementById("mar").value);
    var d = Number(document.getElementById("apr").value);
    var e = Number(document.getElementById("may").value);
    var f = Number(document.getElementById("jun").value);
    var g = Number(document.getElementById("jul").value);
    var h = Number(document.getElementById("aug").value);
    var j = Number(document.getElementById("sep").value);
    var k = Number(document.getElementById("oct").value);
    var l = Number(document.getElementById("nov").value);
    var m = Number(document.getElementById("dec").value);
    var myChart = new Chart(ctx, {
        type: "line",
        data: {
            labels: [
                "Jan", "Feb","Mar", "Apr", "May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",
            ],
            datasets: [
                {

                    data: [a,b, c, d, e,f,g,h,j,k,l,m],
                    backgroundColor: "rgba(192,132,132,0.66)",
                },

            ],
        },
        options: {
            legend: {display: false},
            title: {
                display: true,
                text: "2022 Incident reports Trend"
            }
        }

    });
</script>

<input id = "totUsers" type="hidden"  th:value="${DashStats.getNumUsers()}">
<input id = "totMusers" type="hidden"  th:value="${DashStats.getMUsers()}">

<input id = "totOffenders" type="hidden"  th:value="${DashStats.getNumOffenders()}">
<input id = "totMoffenders" type="hidden"  th:value="${DashStats.getMOffenders()}">

<input id = "vic" type="hidden"  th:value="${DashStats.getVictims()}">
<input id = "mVic" type="hidden"  th:value="${DashStats.getMVictims()}">

<script>
    var xValues = ["Male", "Female"];
    var mUsers = Number(document.getElementById("totMusers").value);
    var totUsers = Number(document.getElementById("totUsers").value);
    var fUsers = totUsers - mUsers;
    var yValues = [mUsers, fUsers];
    var barColors = [
        "#923D41",
        "#e8c3b9"
    ];

    new Chart("myUserChart", {
        type: "doughnut",
        data: {
            labels: xValues,
            datasets: [{
                backgroundColor: barColors,
                data: yValues
            }]
        },
        options: {
            title: {
                display: true,
                text:"Gender distribution of Users"
            }
        }
    });
</script>

<script>
    var xValues = ["Male", "Female"];
    var mVic = Number(document.getElementById("mVic").value);
    var Vic = Number(document.getElementById("vic").value);
    var fVic = Vic - mVic;
    var yValues = [mVic, fVic];
    var barColors = [
        "rgba(217,38,38,0.82)",
        "#E8B9C09B"
    ];

    new Chart("myVicChart", {
        type: "doughnut",
        data: {
            labels: xValues,
            datasets: [{
                backgroundColor: barColors,
                data: yValues
            }]
        },
        options: {
            title: {
                display: true,
                text: "Gender distribution of Victims"
            }
        }
    });
</script>

<script>
    var xValues = ["Male", "Female"];
    var mOff = Number(document.getElementById("totMoffenders").value);
    var totOff= Number(document.getElementById("totOffenders").value);
    var fOff = totOff - mOff;
    var yValues = [mOff, fOff];
    var barColors = [
        "rgba(157,32,32,0.82)",
        "rgba(232,185,192,0.78)"
    ];

    new Chart("myOffChart", {
        type: "doughnut",
        data: {
            labels: xValues,
            datasets: [{
                backgroundColor: barColors,
                data: yValues
            }]
        },
        options: {
            title: {
                display: true,
                text: "Gender distribution of Offenders"
            }
        }
    });
</script>


</body>
</html>


<script>
    function openNav() {
        document.getElementById("navbarVertical").style.width = "260px";
        document.getElementById("main").style.marginLeft = "0px";
    }

    function closeNav() {
        document.getElementById("navbarVertical").style.width = "0";
        document.getElementById("main").style.marginLeft= "0";
    }
</script>
